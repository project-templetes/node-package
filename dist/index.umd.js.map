{"version":3,"file":"index.umd.js","sources":["../src/index.js"],"sourcesContent":["#!/usr/bin/env node\n\nimport * as fs from \"fs\";\nimport * as path from \"path\";\nimport inquirer from \"inquirer\";\nimport { Command } from \"commander\";\n\nconst Error = \"\\x1b[31m%s\\x1b[0m\"; // ANSI escape code for red text\nconst Green = \"\\x1b[32m%s\\x1b[0m\"; // ANSI escape code for green text\nconst Blue = \"\\x1b[34m%s\\x1b[0m\"; // ANSI escape code for blue text\nconst Reset = \"\\x1b[0m\"; // ANSI escape code to reset color\n\nasync function askQuestion(cwd){\n  const dir = await handleDirPrompt(cwd, cwd);\n  const [baseDir, statesDir] = await handleDirNamePrompt(dir);\n  const framework = await handleFrameworkPrompt();\n  const typescript = await handleTypescriptPrompt();\n  console.log('\\x1b[32m->\\x1b[0m \\x1b[34m', baseDir, Reset);\n  console.log('\\x1b[32m->\\x1b[0m \\x1b[34m', framework, typescript ? 'TS' : 'JS', Reset);\n  return {\n    baseDir,\n    statesDir,\n    framework,\n    typescript,\n  }\n}\n\nasync function handleDirPrompt(cwd, dir) {\n  const ans = await inquirer.prompt([\n    {\n      type: \"input\",\n      name: \"baseDir\",\n      message: \"Where do you want to create the redux-provider?\",\n      default: dir.split(path.sep).pop(),\n    },\n  ]);\n\n  // if ans.dir is equal to detault value, then it means the user wants to create the redux-provider in the current directory. So we return the current directory\n\n  if (ans.baseDir !== dir.split(path.sep).pop()) {\n    if (path.isAbsolute(ans.baseDir)) { // Check if the provided path is absolute\n      dir = ans.baseDir;\n    } else {\n      dir = path.join(dir, ans.baseDir);\n    }\n  } \n\n  const exists = fs.existsSync(dir);\n  if (!exists) {\n    console.log(Error, `Directory ${dir} does not exist`);\n    dir = path.join(dir, \"..\");\n    console.log(Green, dir);\n    const dirs = fs.readdirSync(dir).filter((file) => (!file.startsWith(\".\") && fs.statSync(path.join(dir, file)).isDirectory()));\n    console.log(\"Available folders in the directory: \");\n    dirs.forEach((dir) => {\n      console.log(Blue, dir);\n    });\n    return handleDirPrompt(cwd, dir);\n  }\n\n  const confirm = await inquirer.prompt([\n    {\n      type: \"confirm\",\n      name: \"confirm\",\n      message: `Is this the correct directory? ${dir}`,\n      default: true,\n    },\n  ]);\n\n  if (!confirm.confirm) {\n    console.log(Green, dir);\n    const dirs = fs.readdirSync(dir).filter((file) => (!file.startsWith(\".\") && fs.statSync(path.join(dir, file)).isDirectory()));\n    console.log(\"Available folders in the directory: \");\n    dirs.forEach((dir) => {\n      console.log(Blue, dir);\n    });\n    return handleDirPrompt(cwd, dir);\n  }\n  return dir;\n}\n\nasync function handleDirNamePrompt(dir) {\n  const ans = await inquirer.prompt([\n    {\n      type: \"input\",\n      name: \"dir\",\n      message: \"Enter the name of the directory\",\n      default: \"redux-provider\",\n    },\n  ]);\n\n  const exists = fs.existsSync(path.join(dir, ans.dir));\n  if (exists) {\n    console.log(Error, `Directory ${dir} already exists`);\n    return handleDirNamePrompt(dir);\n  }\n\n  return [\n    path.join(dir, ans.dir),\n    path.join(dir, ans.dir, \"states\"),\n  ]\n}\n\nasync function handleFrameworkPrompt() {\n  const ans = await inquirer.prompt([\n    {\n      type: \"list\",\n      name: \"framework\",\n      message: \"What type of project you are using?\",\n      choices: [\"Next\", \"React\"],\n    },\n  ]);\n\n  return ans.framework;\n}\n\nasync function handleTypescriptPrompt() {\n  const ans = await inquirer.prompt([\n    {\n      type: \"confirm\",\n      name: \"typescript\",\n      message: \"Are you using TypeScript?\",\n    },\n  ]);\n\n  return ans.typescript;\n}\n\nfunction create(config) {\n  const baseDir = config.baseDir;\n  const statesDir = config.statesDir;\n  const isNext = \"next\" === `${config.framework}`.toLowerCase();\n  const isTypescript = config.typescript;\n\n  // Create directories\n  fs.mkdirSync(statesDir, { recursive: true });\n\n  // Create and write to auth.[ts|js]\n  const authContent = `${isNext ? \"'use client';\" : \"\"}\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport { useLocalStorage } from \"../use-local-storage\";\n\nconst {\n    readLocalStorage, \n    updateLocalStorage\n} = useLocalStorage('auth', {\n    isAuth: false,\n    token: \"\",\n  });\n  \nconst auth = createSlice({\n    name: \"auth\",\n    initialState: readLocalStorage(),\n    reducers: {\n        logout: () => updateLocalStorage(null),\n        login: (state, action) =>  updateLocalStorage({\n            isAuth: true,\n            ...(action.payload)\n        })\n\n    }\n})\n\nexport default auth;\n`;\n  fs.writeFileSync(path.join(statesDir, isTypescript ? 'auth.ts' : 'auth.js'), authContent);\n\n  // Create and write to index.[tsx|jsx]\n  const indexContent = `${isNext ? \"'use client';\" : \"\"}\nimport { Provider } from \"react-redux\";\nimport { configureStore } from \"@reduxjs/toolkit\";\nimport auth from \"./states/auth\";\nimport React, { useEffect } from \"react\";\nconst store = configureStore({\n  reducer: {\n    auth: auth.reducer,\n  },\n});\nexport const authActions = auth.actions;\nexport default function ReduxProvider({ children }${isTypescript ? \": { children: React.ReactNode }\" : \"\"}) {\n  useEffect(() => {}, []);\n  return <Provider store={store}>{children}</Provider>;\n};\n`;\n  fs.writeFileSync(path.join(baseDir, isTypescript ? 'index.tsx' : 'index.jsx'), indexContent);\n\n  // Create and write to use-local-storage.[ts|js]\n  const useLocalStorageContent = `export const useLocalStorage = (key${isTypescript ? \": string\" : \"\"}, defaultState${isTypescript ? \": any\" : \"\"}) => {\n  return {\n      updateLocalStorage: (data${isTypescript ? \": any\" : \"\"} = null) => {\n          if (!data) return localStorage.removeItem(key);\n          localStorage.setItem(key, JSON.stringify(data));\n      },\n      readLocalStorage: () => {\n          if (typeof window !== 'undefined') {\n            const data = localStorage.getItem(key);\n            return !!data && data !== \"undefined\"\n              ? JSON.parse(data) \n              : defaultState;\n          } \n          return defaultState;\n        },\n        \n  }\n}\n`;\n  fs.writeFileSync(\n    path.join(baseDir, isTypescript ? 'use-local-storage.ts' : 'use-local-storage.js'),\n    useLocalStorageContent\n  );\n\n  console.log(\"Redux provider structure created successfully.\");\n}\n\nconst program = new Command();\n\nprogram.parse(process.argv);\n\nif (program.args.length === 0) {\n    const cwd = process.cwd();\n    askQuestion(cwd)\n    .then(async (ans) => {\n        create(ans);\n    })\n    .catch(err => {\n        if (err.name === 'ExitPromptError') {\n            console.log(Error, 'Prompt was force closed by the user.');\n        } else {\n            console.error(err);\n        }\n    });\n}"],"names":["cwd","handleDirNamePrompt","dir","Promise","resolve","inquirer","prompt","type","name","message","default","then","ans","fs","existsSync","path","join","console","log","Error","e","reject","handleDirPrompt","split","sep","pop","baseDir","isAbsolute","Green","dirs","readdirSync","filter","file","startsWith","statSync","isDirectory","forEach","Blue","confirm","Reset","program","Command","parse","process","argv","args","length","_ref","statesDir","choices","framework","handleFrameworkPrompt","typescript","handleTypescriptPrompt","config","isNext","toLowerCase","isTypescript","mkdirSync","recursive","authContent","writeFileSync","indexContent","useLocalStorageContent","create","err","error"],"mappings":"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"}